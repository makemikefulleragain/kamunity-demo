"use strict";(()=>{var e={};e.id=738,e.ids=[738],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5315:e=>{e.exports=require("path")},9338:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var o={};r.r(o),r.d(o,{POST:()=>d});var a=r(9303),i=r(8716),n=r(3131),s=r(7070);let p=require("fs/promises");var u=r(5315);let l={"image/jpeg":".jpg","image/png":".png","image/gif":".gif","application/pdf":".pdf","text/plain":".txt","application/vnd.openxmlformats-officedocument.wordprocessingml.document":".docx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":".xlsx"};async function d(e){try{var t;let r=await e.formData(),o=r.get("file"),a=r.get("roomId");if(r.get("userId"),!o)return s.NextResponse.json({error:"No file provided"},{status:400});if(!a)return s.NextResponse.json({error:"Room ID required"},{status:400});if(!l[o.type])return s.NextResponse.json({error:"File type not allowed. Supported: images, PDF, text, Word, Excel"},{status:400});if(o.size>10485760)return s.NextResponse.json({error:"File too large. Maximum size: 10MB"},{status:400});let i=(0,u.join)(process.cwd(),"public","uploads",a);await (0,p.mkdir)(i,{recursive:!0});let n=Date.now();l[o.type];let d=`${n}-${o.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,c=(0,u.join)(i,d),m=await o.arrayBuffer(),f=Buffer.from(m);return await (0,p.writeFile)(c,f),s.NextResponse.json({success:!0,upload:{filename:o.name,fileType:(t=o.type).startsWith("image/")?"image":"application/pdf"===t||t.includes("word")||t.includes("text")||t.includes("sheet")||t.includes("excel")?"document":"other",fileSize:o.size,storageLocation:`/uploads/${a}/${d}`,uploadedAt:new Date().toISOString()}})}catch(e){return console.error("Upload error:",e),s.NextResponse.json({error:"Upload failed. Please try again."},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/content/upload/route",pathname:"/api/content/upload",filename:"route",bundlePath:"app/api/content/upload/route"},resolvedPagePath:"C:\\dev\\kamunity-final\\src\\app\\api\\content\\upload\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:g}=c,x="/api/content/upload/route";function v(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[948,972],()=>r(9338));module.exports=o})();
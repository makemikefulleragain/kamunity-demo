(()=>{var e={};e.id=310,e.ids=[310],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},8359:()=>{},3739:()=>{},9877:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>q,patchFetch:()=>g,requestAsyncStorage:()=>x,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{GET:()=>d,POST:()=>p});var n=r(9303),o=r(8716),i=r(3131),a=r(7070);let c=(0,r(2438).eI)("https://your-project.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY),u=["fun","spot_on","spicy","nice","weird","intriguing"];async function p(e){try{let t;let{contentId:r,contentType:s,reactionType:n,userId:o}=await e.json();if(!r||!s||!n||!o)return a.NextResponse.json({error:"Missing required fields: contentId, contentType, reactionType, userId"},{status:400});if(!u.includes(n))return a.NextResponse.json({error:`Invalid reaction type. Allowed: ${u.join(", ")}`},{status:400});let{data:i}=await c.from("reactions").select("*").eq("user_id",o).eq("content_id",r).eq("content_type",s).single();if(i){if(i.reactionType===n)return await c.from("reactions").delete().eq("id",i.id),a.NextResponse.json({success:!0,action:"removed",reactionType:n});{let{data:e}=await c.from("reactions").update({reaction_type:n}).eq("id",i.id).select().single();t=e}}else{let{data:e}=await c.from("reactions").insert({user_id:o,content_id:r,content_type:s,reaction_type:n}).select().single();t=e}return a.NextResponse.json({success:!0,action:i?"updated":"created",reaction:{id:t.id,reactionType:t.reactionType,user:t.user,createdAt:t.createdAt}})}catch(e){return console.error("Reaction error:",e),a.NextResponse.json({error:"Failed to process reaction. Please try again."},{status:500})}}async function d(e){try{let{searchParams:t}=new URL(e.url),r=t.get("contentId"),s=t.get("contentType");if(!r||!s)return a.NextResponse.json({error:"Missing contentId and contentType parameters"},{status:400});let{data:n}=await c.from("reactions").select("*, user:users(id, name)").eq("content_id",r).eq("content_type",s).order("created_at",{ascending:!1}),o=u.reduce((e,t)=>(e[t]=(n||[]).filter(e=>e.reaction_type===t).length,e),{});return a.NextResponse.json({reactions:n||[],counts:o,total:(n||[]).length})}catch(e){return console.error("Get reactions error:",e),a.NextResponse.json({error:"Failed to fetch reactions. Please try again."},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/reactions/route",pathname:"/api/reactions",filename:"route",bundlePath:"app/api/reactions/route"},resolvedPagePath:"C:\\dev\\kamunity-final\\src\\app\\api\\reactions\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:y,serverHooks:f}=l,q="/api/reactions/route";function g(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:y})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,972,438],()=>r(9877));module.exports=s})();